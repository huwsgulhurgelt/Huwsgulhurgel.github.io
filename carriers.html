<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>–ë–æ–ª–æ–º–∂–∏—Ç —Ö“Ø—Ä–≥—ç–≥—á–∏–¥</title>
  <style>
    body { font-family: Arial; background:#f9f9f9; padding:20px; }
    .card { background:white; padding:15px; margin:15px auto; max-width:400px;
            border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,.1); }
    button { margin-right:10px; padding:8px 12px; font-size:16px; }
    a { display:block; text-align:center; margin-top:30px; color:#2196F3; text-decoration:none; }
  </style>
</head>
<body>

<h1 style="text-align:center;">–ë–æ–ª–æ–º–∂–∏—Ç —Ö“Ø—Ä–≥—ç–≥—á–∏–¥</h1>
<div id="list"></div>
<a href="index.html">‚Üê –ë—É—Ü–∞—Ö</a>

<script>
let carriers = JSON.parse(localStorage.getItem("carriers")) || [];
const list = document.getElementById("list");

// Migrate old posts without PIN
carriers = carriers.map(c => {
  if (!c.pin) c.pin = "0000"; // old posts get default PIN
  return c;
});
localStorage.setItem("carriers", JSON.stringify(carriers));

function render() {
  list.innerHTML = "";
  if (carriers.length === 0) {
    list.innerHTML = "<p style='text-align:center;color:gray;'>–•–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞</p>";
    return;
  }

  carriers.forEach((c, index) => {
    const div = document.createElement("div");
    div.className = "card";

    div.innerHTML = `
      <p><strong>–£—Ç–∞—Å:</strong> ${c.phone}</p>
      <p><strong>–¢–∞–π–ª–±–∞—Ä:</strong> ${c.description}</p>
      <button onclick="editCarrier(${index})">‚úèÔ∏è –ó–∞—Å–∞—Ö</button>
      <button onclick="deleteCarrier(${index})">üóëÔ∏è –£—Å—Ç–≥–∞—Ö</button>
    `;
    list.appendChild(div);
  });
}

function deleteCarrier(index) {
  const pin = prompt("–ù—É—É—Ü PIN –æ—Ä—É—É–ª–Ω–∞ —É—É:");
  if (!pin) return;

  if (carriers[index].pin === pin) {
    carriers.splice(index,1);
    localStorage.setItem("carriers", JSON.stringify(carriers));
    render();
  } else {
    alert("PIN –±—É—Ä—É—É –±–∞–π–Ω–∞");
  }
}

function editCarrier(index) {
  const pin = prompt("–ù—É—É—Ü PIN –æ—Ä—É—É–ª–Ω–∞ —É—É:");
  if (!pin) return;

  if (carriers[index].pin === pin) {
    const newPhone = prompt("–®–∏–Ω—ç —É—Ç–∞—Å:", carriers[index].phone);
    const newDesc = prompt("–®–∏–Ω—ç —Ç–∞–π–ª–±–∞—Ä:", carriers[index].description);

    if (newPhone) carriers[index].phone = newPhone;
    if (newDesc) carriers[index].description = newDesc;

    localStorage.setItem("carriers", JSON.stringify(carriers));
    render();
  } else {
    alert("PIN –±—É—Ä—É—É –±–∞–π–Ω–∞");
  }
}

render();
</script>

</body>
</html>
